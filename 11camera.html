<!DOCTYPE html>
<html>
<head>
    <title>Управление камерой</title>
    <style>
        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }
        #video {
            border: 2px solid green;
            margin-top: 20px;
        }
        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px;
        }
    </style>
</head>
<body>
    <h1>Контроль камеры</h1>
    <button id="startBtn" onclick="startCamera()">Согласен</button>
    <button id="stopBtn" onclick="stopCamera()" disabled>Отключить камеру</button>
    <video id="video" width="640" height="480" autoplay></video>

    <script>
        let stream = null; // Переменная для хранения потока с камеры

        // Включение камеры
        async function startCamera() {
            try {
                stream = await navigator.mediaDevices.getUserMedia({ video: true });
                const video = document.getElementById('video');
                video.srcObject = stream;

                // Активируем кнопку "Отключить" и деактивируем "Согласен"
                document.getElementById('startBtn').disabled = true;
                document.getElementById('stopBtn').disabled = false;
            } catch (err) {
                alert("Ошибка: " + err.message);
            }
        }

        // Отключение камеры
        function stopCamera() {
            if (stream) {
                const tracks = stream.getTracks();
                tracks.forEach(track => track.stop()); // Останавливаем все треки
                const video = document.getElementById('video');
                video.srcObject = null;

                // Деактивируем кнопку "Отключить" и активируем "Согласен"
                document.getElementById('stopBtn').disabled = true;
                document.getElementById('startBtn').disabled = false;
            }
        }

        // Защита от внешнего отключения (например, через закрытие окна)
        window.onbeforeunload = function() {
            if (stream) {
                return "Камера все еще активна. Вы уверены, что хотите закрыть страницу?";
            }
        };
    </script>
</body>
</html>